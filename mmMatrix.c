#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <math.h>
#include "mmMatrix.h"

extern int mmflag;

int BLOSUM30[20][20] = { 
  {4, -1,  0,  0, -3,  1,  0,  0, -2, 0, -1,  0,  1, -2, -1,  1,  1, -5, -4,  1},  
 {-1,  8, -2, -1, -2,  3, -1, -2, -1, -3, -2,  1,  0, -1, -1, -1, -3,  0,  0, -1}, 
  {0, -2,  8,  1, -1, -1, -1,  0, -1,  0, -2 , 0,  0, -1, -3,  0,  1, -7, -4, -2 }, 
  {0, -1,  1,  9, -3, -1,  1, -1, -2, -4, -1,  0, -3, -5, -1,  0, -1, -4, -1, -2}, 
 {-3, -2, -1, -3, 17, -2,  1, -4, -5 ,-2,  0, -3, -2, -3, -3, -2, -2, -2, -6, -2},
  {1,  3, -1, -1, -2,  8,  2, -2,  0 ,-2, -2,  0, -1, -3,  0, -1,  0, -1, -1, -3},
  {0, -1, -1,  1,  1,  2,  6, -2 , 0 ,-3, -1,  2, -1, -4,  1,  0, -2, -1, -2, -3},
  {0, -2,  0, -1, -4, -2, -2,  8, -3, -1, -2, -1, -2, -3, -1,  0, -2,  1, -3, -3},
 {-2, -1, -1, -2, -5,  0,  0, -3, 14, -2 ,-1, -2,  2, -3,  1, -1, -2, -5,  0, -3},
  {0, -3, 0,  -4, -2, -2, -3, -1, -2,  6,  2, -2,  1,  0, -3, -1,  0, -3 ,-1,  4 },
 {-1, -2, -2, -1,  0, -2, -1, -2, -1,  2,  4, -2,  2,  2, -3, -2,  0, -2,  3,  1},
  {0,  1,  0,  0, -3,  0,  2, -1, -2 ,-2, -2,  4,  2, -1,  1,  0, -1, -2, -1, -2},
  {1,  0,  0, -3, -2, -1, -1, -2,  2,  1,  2,  2,  6, -2, -4, -2,  0, -3, -1,  0},
 {-2, -1, -1, -5, -3, -3, -4, -3, -3,  0 , 2, -1, -2, 10, -4, -1, -2,  1,  3,  1},
 {-1, -1, -3, -1, -3,  0,  1, -1,  1, -3 ,-3,  1, -4, -4, 11, -1,  0, -3, -2, -4} ,
  {1, -1,  0,  0, -2, -1,  0,  0, -1 ,-1 ,-2,  0, -2, -1, -1,  4,  2, -3, -2, -1},
  {1, -3,  1, -1, -2,  0, -2, -2, -2,  0 , 0, -1,  0, -2,  0,  2,  5, -5, -1,  1},
 {-5,  0, -7, -4, -2, -1, -1,  1, -5, -3, -2, -2, -3,  1, -3, -3, -5, 20,  5, -3},
 {-4,  0, -4, -1, -6, -1, -2 ,-3 , 0, -1,  3, -1, -1,  3, -2, -2, -1,  5,  9,  1},
  {1, -1, -2, -2 ,-2, -3, -3, -3 ,-3,  4,  1, -2,  0,  1, -4, -1,  1, -3,  1,  5},
};


int BLOSUM45[20][20] = { 
  {5, -2, -1, -2, -1, -1, -1,  0, -2, -1, -1, -1, -1, -2, -1,  1,  0, -2, -2,  0}, 
 {-2,  7,  0, -1, -3,  1,  0, -2,  0, -3, -2,  3, -1, -2, -2, -1, -1, -2, -1, -2},
 {-1,  0,  6,  2, -2,  0,  0,  0,  1, -2, -3,  0, -2, -2, -2,  1,  0, -4, -2, -3}, 
 {-2, -1,  2,  7, -3,  0,  2, -1,  0, -4, -3,  0, -3, -4, -1,  0, -1, -4, -2, -3}, 
 {-1, -3, -2, -3, 12, -3, -3, -3, -3, -3, -2, -3, -2, -2, -4, -1, -1, -5, -3, -1},
 {-1,  1,  0,  0, -3,  6,  2, -2,  1, -2, -2,  1,  0, -4, -1,  0, -1, -2, -1, -3}, 
 {-1,  0,  0,  2, -3,  2,  6, -2,  0, -3, -2,  1, -2, -3,  0,  0, -1, -3, -2, -3},
  {0, -2,  0, -1, -3, -2, -2,  7, -2, -4, -3, -2, -2, -3, -2,  0, -2, -2, -3, -3},
 {-2,  0,  1,  0, -3,  1,  0, -2, 10, -3, -2, -1,  0, -2, -2, -1, -2, -3,  2, -3},
 {-1, -3, -2, -4, -3, -2, -3, -4, -3,  5,  2, -3,  2,  0, -2, -2, -1, -2,  0,  3},
 {-1, -2, -3, -3, -2, -2, -2, -3, -2,  2,  5, -3,  2,  1, -3, -3, -1, -2,  0,  1},
 {-1,  3,  0,  0, -3,  1,  1, -2, -1, -3, -3,  5, -1, -3, -1, -1, -1, -2, -1, -2},
 {-1, -1, -2, -3, -2,  0, -2, -2,  0,  2,  2, -1,  6,  0, -2, -2, -1, -2,  0,  1},
 {-2, -2, -2, -4, -2, -4, -3, -3, -2,  0,  1, -3,  0,  8, -3, -2, -1,  1,  3,  0},
 {-1, -2, -2, -1, -4, -1,  0, -2, -2, -2, -3, -1, -2, -3,  9, -1, -1, -3, -3, -3},
  {1, -1,  1,  0, -1,  0,  0,  0, -1, -2, -3, -1, -2, -2, -1,  4,  2, -4, -2, -1},
  {0, -1,  0, -1, -1, -1, -1, -2, -2, -1, -1, -1, -1, -1, -1,  2,  5, -3, -1,  0},
 {-2, -2, -4, -4, -5, -2, -3, -2, -3, -2, -2, -2, -2,  1, -3, -4, -3, 15,  3, -3},
 {-2, -1, -2, -2, -3, -1, -2, -3,  2,  0,  0, -1,  0,  3, -3, -2, -1,  3,  8, -1},
  {0, -2, -3, -3, -1, -3, -3, -3, -3,  3,  1, -2,  1,  0, -3, -1,  0, -3, -1,  5}
};

int BLOSUM62[20][20] = {
   {4, -1, -2,-2,  0 ,-1 ,-1 ,0, -2, -1, -1, -1, -1, -2, -1,  1,  0, -3, -2,  0}, 
  {-1,  5,  0,-2, -3  ,1  ,0, -2,  0, -3, -2,  2, -1, -3, -2, -1, -1, -3, -2, -3},  
  {-2, 0 , 6 ,1, -3  ,0  ,0 , 0,  1, -3, -3,  0, -2, -3, -2,  1,  0, -4, -2, -3},
  {-2, -2, 1 ,6, -3  ,0 , 2 ,-1, -1, -3, -4, -1, -3, -3, -1,  0, -1, -4, -3, -3}, 
   {0, -3,-3 ,-3,  9 ,-3 ,-4 ,-3, -3, -1, -1, -3, -1, -2, -3, -1, -1, -2, -2, -1},
  {-1, 1 , 0 , 0, -3 , 5 , 2 ,-2,  0, -3, -2,  1,  0, -3, -1,  0, -1, -2, -1, -2},
  {-1,0  ,0  , 2 ,-4 , 2 , 5 ,-2,  0, -3, -3,  1, -2, -3, -1,  0, -1, -3, -2, -2},
  { 0,-2 , 0 ,-1 ,-3 ,-2 ,-2 , 6, -2, -4, -4, -2, -3, -3, -2,  0, -2, -2, -3, -3},
  {-2, 0 , 1 ,-1 ,-3 , 0 , 0 ,-2,  8, -3, -3, -1, -2, -1, -2, -1, -2, -2,  2, -3},
  {-1,-3 ,-3 ,-3 ,-1 ,-3 ,-3 ,-4, -3,  4,  2, -3,  1,  0, -3, -2, -1, -3, -1,  3},
  {-1,-2 ,-3 ,-4 ,-1 ,-2 ,-3 ,-4, -3,  2,  4, -2,  2,  0, -3, -2 ,-1 ,-2, -1,  1},
  {-1, 2 , 0 ,-1 ,-3 , 1 , 1 ,-2, -1, -3, -2,  5, -1, -3, -1,  0, -1, -3, -2, -2},
  {-1,-1 ,-2 ,-3 ,-1 , 0 ,-2 ,-3, -2 , 1,  2, -1,  5,  0, -2, -1, -1, -1, -1,  1},
  {-2,-3 ,-3 ,-3 ,-2 ,-3 ,-3 ,-3,-1 , 0,  0, -3,  0,  6, -4, -2, -2,  1,  3, -1},
  {-1,-2 ,-2 ,-1 ,-3 ,-1 ,-1 ,-2, -2, -3, -3, -1, -2, -4,  7, -1, -1, -4, -3, -2},
   {1,-1 , 1 , 0 ,-1 , 0  ,0  ,0, -1, -2, -2,  0, -1, -2, -1,  4,  1, -3, -2, -2}, 
   {0,-1 , 0 ,-1 ,-1 ,-1 ,-1 ,-2, -2, -1, -1, -1, -1, -2, -1,  1,  5, -2, -2,  0},
  {-3, -3, -4 ,-4 ,-2 ,-2 ,-3, -2, -2, -3, -2, -3, -1,  1, -4, -3, -2, 11,  2, -3},
  {-2, -2, -2 ,-3 ,-2 ,-1 ,-2 ,-3,  2, -1, -1, -2, -1,  3, -3, -2, -2,  2,  7, -1},
  { 0, -3, -3 , -3 ,-1, -2 ,-2 ,-3, -3,  3,  1, -2,  1, -1, -2, -2,  0 ,-3, -1,  4}
};

int BLOSUM90[20][20] ={
  {5, -2, -2, -3, -1, -1, -1,  0, -2, -2, -2, -1, -2, -3, -1,  1,  0, -4, -3, -1},
 {-2,  6, -1, -3, -5,  1, -1, -3,  0, -4, -3,  2, -2, -4, -3, -1, -2, -4, -3, -3}, 
 {-2, -1,  7,  1, -4,  0, -1, -1,  0, -4, -4,  0, -3, -4, -3,  0,  0, -5, -3, -4},
 {-3, -3,  1,  7, -5, -1,  1, -2, -2, -5, -5, -1, -4, -5, -3, -1, -2, -6, -4, -5},
 {-1, -5, -4, -5,  9, -4, -6, -4, -5, -2, -2, -4, -2, -3, -4, -2, -2, -4, -4, -2},
 {-1,  1,  0, -1, -4,  7,  2, -3,  1, -4, -3,  1,  0, -4, -2, -1, -1, -3, -3, -3},
 {-1, -1, -1,  1, -6,  2,  6, -3, -1, -4, -4,  0, -3, -5, -2, -1, -1, -5, -4, -3},
  {0, -3, -1, -2, -4, -3, -3,  6, -3, -5, -5, -2, -4, -5, -3, -1, -3, -4, -5, -5},
 {-2,  0,  0, -2, -5,  1, -1, -3,  8, -4, -4, -1, -3, -2, -3, -2, -2, -3,  1, -4},
 {-2, -4, -4, -5, -2, -4, -4, -5, -4,  5,  1, -4,  1, -1, -4, -3, -1, -4, -2,  3},
 {-2, -3, -4, -5, -2, -3, -4, -5, -4,  1,  5, -3,  2,  0, -4, -3, -2, -3, -2,  0},
 {-1,  2,  0, -1, -4,  1,  0, -2, -1, -4, -3,  6, -2, -4, -2, -1, -1, -5, -3, -3},
 {-2, -2, -3, -4, -2,  0, -3, -4, -3,  1,  2, -2,  7, -1, -3, -2, -1, -2, -2,  0},
 {-3, -4, -4, -5, -3, -4, -5, -5, -2, -1,  0, -4, -1,  7, -4, -3, -3,  0,  3, -2},
 {-1, -3, -3, -3, -4, -2, -2, -3, -3, -4, -4, -2, -3, -4,  8, -2, -2, -5, -4, -3},
  {1, -1,  0, -1, -2, -1, -1, -1, -2, -3, -3, -1, -2, -3, -2,  5,  1, -4, -3, -2},
  {0, -2,  0, -2, -2, -1, -1, -3, -2, -1, -2, -1, -1, -3, -2,  1,  6, -4, -2, -1},
 {-4, -4, -5, -6, -4, -3, -5, -4, -3, -4, -3, -5, -2,  0, -5, -4, -4, 11,  2, -3},
 {-3, -3, -3, -4, -4, -3, -4, -5,  1, -2, -2, -3, -2,  3, -4, -3, -2,  2,  8, -3},
 {-1, -3, -4, -5, -2, -3, -3, -5, -4,  3,  0, -3,  0, -2, -3, -2, -1, -3, -3,  5}
 
};

int mmMatrix(int flag, int nn1, int nn2){
    int   Amino_num[25] = {1,0,2,3,4,5,6,7,8,0,9,10,11,12,0,13,14,15,16,17,0,18,19,0,20};

    char AA[] = {'A',  'R',  'N',  'D',  'C',  'Q',  'E', 'G',  'H',  'I',  'L',  'K',  'M', 'F',  'P', 'S', 'T',  'W',  'Y', 'V', '\0'};

    char c1, c2;
    int n1,n2;
    
    int score;
    for (int i=0; i<25; i++){
        if (nn1 == Amino_num[i])
            n1 = i+1;
        if (nn2 == Amino_num[i])
            n2 = i+1;
    }
    c1 = (char)(n1+64);
    c2 = (char)(n2+64);

    for (int i=0; i < 20; i++){
        if (AA[i] == c1){
            for(int j=0; j<20; j++){
                if(AA[j] == c2){
                    if(flag == 0)
                        score = BLOSUM62[i][j];
                    else if (flag == 1)
                        score = BLOSUM30[i][j];
                    else
                        score = BLOSUM90[i][j];
                    
                }
            }

        }
    }

    return score;
}

